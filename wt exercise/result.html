<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Life Journey</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(180deg, #111111, #440000, #111111);
      color: #f5f5f5;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    .container {
      text-align: center;
      background: rgba(0,0,0,0.85);
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 6px 20px rgba(255,0,0,0.4);
    }

    .scene {
      position: relative;
      width: 814px;
      height: 250px;
      margin: 20px auto;
    }

    .person {
      position: absolute;
      left: calc(50% - var(--line-width, 332px)/2 - 120px);
      top: 140px;
      transform: translateY(-50%);
      width: 120px;
      height: 180px;
      object-fit: contain;
      z-index: 2;
      transition: all 1.2s cubic-bezier(.68,-0.55,.27,1.55);
      display: block;
      opacity: 1;
    }

    .person.roast {
      left: calc(50% + var(--line-width, 332px)/2 + 100px);
      top: 65%;
      transform: translate(-50%, -50%) rotate(70deg) scale(0.8);
      opacity: 0.7;
      z-index: 3;
      display: block;
      }
      .person.roast {
        left: calc(50% + var(--line-width, 332px)/2 + 120px);
        top: 60%;
        transform: translate(-50%, -50%) rotate(70deg) scale(0.8);
        opacity: 0.7;
        z-index: 3;
        display: block;
      }

    .coffin.death {
      width: 220px;
      height: 180px;
    }

    .coffin {
      position: absolute;
      left: calc(50% + var(--line-width, 332px)/2 + 20px);
      top: 140px;
      transform: translateY(-50%);
      width: 160px;
      height: 120px;
      object-fit: contain;
      z-index: 2;
    }

    .line {
      position: absolute;
      top: 140px;
      left: 50%;
      transform: translateX(-50%);
      width: var(--line-width, 332px);
      height: 6px;
      background: linear-gradient(90deg, #00ff00, #ffff00, #ff0000);
      border-radius: 3px;
      transition: width 1s ease;
      z-index: 1;
    }

    #remainingText {
      margin-top: 20px;
      font-size: 20px;
      font-weight: bold;
      color: #ff6666;
      letter-spacing: 1px;
    }

    .btn {
      margin-top: 20px;
      padding: 12px 20px;
      background: #ff4444;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      transition: 0.3s;
    }
    .btn:hover {
      background: #cc0000;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>‚ö∞Ô∏è Your Life Journey ‚ö∞Ô∏è</h2>
    <div class="scene">
  <img id="lifePerson" class="person" src="" alt="Person">
  <div id="lifeLine" class="line"></div>
  <img class="coffin" src="images/coffin.png" alt="Coffin">
    </div>
    <div id="remainingText">Calculating...</div>
    <button class="btn" onclick="window.location.href='index.html'">Try Again</button>
  </div>

  <script>
    const data = JSON.parse(localStorage.getItem("lifeData"));

    if (data) {
      // person image
      const imgPerson = document.getElementById("lifePerson");
      if (data.gender === "Male") {
        imgPerson.src = "images/man.png";
      } else if (data.gender === "Female") {
        imgPerson.src = "images/female.png";
      } else {
        imgPerson.src = "https://cdn-icons-png.flaticon.com/512/1077/1077114.png";
      }

      const birthYear = parseInt(data.birthyear);
      const currentYear = new Date().getFullYear();
      const age = currentYear - birthYear;

      let lifeExpectancy = 85; // base

      // Food effects
      if (data.foods.toLowerCase().includes("junk")) {
        lifeExpectancy -= 20;
      } else if (data.foods.toLowerCase().includes("healthy") || data.foods.toLowerCase().includes("fruits")) {
        lifeExpectancy += 5;
      }

      // Lifestyle effects
      if (data.lifestyle.toLowerCase().includes("sedentary")) {
        lifeExpectancy -= 10;
      } else if (data.lifestyle.toLowerCase().includes("active")) {
        lifeExpectancy += 5;
      }

      const remaining = lifeExpectancy - age;
      const line = document.getElementById("lifeLine");
      const remainingText = document.getElementById("remainingText");

      if (remaining <= 0 || (age > 70 && data.foods.toLowerCase().includes("junk"))) {
        const lineWidth = 40;
        line.style.setProperty('--line-width', lineWidth + 'px');
        remainingText.textContent = "üíÄ Your time is up!";
        imgPerson.classList.add('roast');
        imgPerson.style.display = 'block';
        document.querySelector('.coffin').classList.add('death');
      } else {
        document.querySelector('.coffin').classList.remove('death');
        // Convert to years/months/days
        const years = Math.floor(remaining);
        const months = Math.floor((remaining - years) * 12);
        const days = Math.floor(((remaining - years) * 365) % 30);

        const text = `${years > 0 ? years + " years " : ""}${months > 0 ? months + " months " : ""}${days > 0 ? days + " days " : ""}remaining`;

        remainingText.textContent = text;

        // Scale line based on remaining years
        const maxWidth = 500;
        const lineWidth = Math.max(40, Math.min(maxWidth, remaining * 20));
        line.style.setProperty('--line-width', lineWidth + 'px');
        imgPerson.classList.remove('roast');
      }
    }
  </script>
</body>
</html>
